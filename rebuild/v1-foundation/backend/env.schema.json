{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LML v1 Foundation - Environment Schema",
  "description": "Required and optional environment variables for LML backend",
  "type": "object",
  "required": [
    "NODE_ENV",
    "DATABASE_URL",
    "MONGODB_URI",
    "MONGODB_DB",
    "REDIS_URL",
    "JWT_SECRET"
  ],
  "properties": {
    "NODE_ENV": {
      "type": "string",
      "enum": ["development", "staging", "production"],
      "description": "Application environment"
    },
    "DATABASE_URL": {
      "type": "string",
      "pattern": "^postgresql://",
      "description": "PostgreSQL connection string"
    },
    "MONGODB_URI": {
      "type": "string", 
      "pattern": "^mongodb://",
      "description": "MongoDB connection string"
    },
    "MONGODB_DB": {
      "type": "string",
      "minLength": 1,
      "description": "MongoDB database name"
    },
    "REDIS_URL": {
      "type": "string",
      "pattern": "^redis://",
      "description": "Redis connection string"
    },
    "JWT_SECRET": {
      "type": "string",
      "minLength": 32,
      "description": "JWT signing secret (minimum 32 characters)"
    },
    "JWT_EXPIRES_IN": {
      "type": "string",
      "default": "1h",
      "description": "JWT token expiry (e.g., '1h', '7d', '15m')"
    },
    "SESSION_REDIS_URL": {
      "type": "string",
      "pattern": "^redis://",
      "description": "Redis connection for session storage and token blacklist"
    },
    "SECURITY_WEBHOOK_URL": {
      "type": "string",
      "format": "uri",
      "description": "Webhook URL for security violation alerts"
    },
    "NEXT_PUBLIC_APP_URL": {
      "type": "string",
      "format": "uri",
      "description": "Public application URL"
    },
    "STRIPE_SECRET_KEY": {
      "type": "string",
      "pattern": "^sk_(test_|live_)",
      "description": "Stripe secret key (test or live)"
    },
    "NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY": {
      "type": "string", 
      "pattern": "^pk_(test_|live_)",
      "description": "Stripe publishable key (test or live)"
    },
    "STRIPE_WEBHOOK_SECRET": {
      "type": "string",
      "pattern": "^whsec_",
      "description": "Stripe webhook endpoint secret"
    },
    "NEXTAUTH_URL": {
      "type": "string",
      "format": "uri",
      "description": "NextAuth.js canonical URL"
    },
    "NEXTAUTH_SECRET": {
      "type": "string",
      "minLength": 32,
      "description": "NextAuth.js encryption secret (32+ chars)"
    },
    "SMTP_HOST": {
      "type": "string",
      "description": "SMTP server hostname"
    },
    "SMTP_PORT": {
      "type": "string",
      "pattern": "^[0-9]+$",
      "description": "SMTP server port"
    },
    "SMTP_USER": {
      "type": "string",
      "description": "SMTP username"
    },
    "SMTP_PASS": {
      "type": "string",
      "description": "SMTP password"
    },
    "EMAIL_FROM": {
      "type": "string",
      "format": "email",
      "description": "Default 'from' email address"
    },
    "API_VERSION": {
      "type": "string",
      "default": "v1",
      "description": "API version identifier"
    },
    "API_PREFIX": {
      "type": "string",
      "default": "/api/v1",
      "description": "API route prefix"
    },
    "LOG_LEVEL": {
      "type": "string",
      "enum": ["error", "warn", "info", "debug"],
      "default": "info",
      "description": "Application log level"
    },
    "ENABLE_SQL_LOGGING": {
      "type": "string",
      "enum": ["true", "false"],
      "default": "false",
      "description": "Enable SQL query logging"
    },
    "ENABLE_API_LOGGING": {
      "type": "string",
      "enum": ["true", "false"], 
      "default": "true",
      "description": "Enable API request logging"
    },
    "RATE_LIMIT_REQUESTS": {
      "type": "string",
      "pattern": "^[0-9]+$",
      "default": "100",
      "description": "Rate limit: requests per window"
    },
    "RATE_LIMIT_WINDOW_MS": {
      "type": "string",
      "pattern": "^[0-9]+$",
      "default": "60000",
      "description": "Rate limit: window size in milliseconds"
    },
    "NEXT_TELEMETRY_DISABLED": {
      "type": "string",
      "enum": ["1", "0"],
      "default": "1",
      "description": "Disable Next.js telemetry"
    }
  },
  "additionalProperties": false
}